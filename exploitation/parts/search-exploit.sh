#!/bin/bash
# Search Exploits

####################
# Global variables #
####################

DEPENDENCIES="searchsploit"

myVULNFILE="../src/vuln-findings.xml"
myEXPLOITFILE="output/exploit-findings.json"

################################
# Installation of Dependencies #
################################

fuGET_DEPS

###########################
# Create output directory #
###########################

if [ ! -d "output/" ]; then
  fuINFO "creating \"output/\" directory"
  mkdir output && echo "[ OK ]"
fi

##################
# Search Exploits #
###################

# searchsploit
# search through exploits and shellcodes from nmap vulners scan
if [ -s "$myVULNFILE" ]; then
  fuTITLE "Search exploits from Nmap vulnerability findings"
  searchsploit --nmap $myVULNFILE --color -www | tee $myEXPLOITFILE
else
  fuINFO "File $myVULNFILE not found, check vulnerability-scanning.sh from reconnaissance phase"
fi

#####################
# Summarize results #
#####################

fuTITLE "Findings in following files:"
if [ -s "$myEXPLOITFILE" ]; then
  fuINFO "Exploits found in: $myEXPLOITFILE"
else
  fuINFO "No exploits found"
fi
echo